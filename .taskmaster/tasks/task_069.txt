# Task ID: 69
# Title: Implement Turn Pattern Validation
# Status: in-progress
# Dependencies: 5
# Priority: medium
# Description: Implement strict validation for turn patterns, ensuring they are comma-separated sequences of 'drawing' and 'writing', and reject invalid formats with clear errors.
# Details:
Create a dedicated validation function or module for turn patterns. This function should accept a string input representing the turn pattern. It should parse the input string by splitting it by commas. Validate that each resulting part, after trimming whitespace, is exactly 'drawing' or 'writing'. Handle edge cases like empty strings, strings with extra commas, and non-string inputs, considering them invalid. If the input is valid, return a parsed representation (e.g., an array of strings). If invalid, throw a specific error or return a clear error message string. Integrate this validation into the process where turn patterns are provided, likely the `/new season` command handler or the `SeasonService` method responsible for creating seasons/games. Ensure the error messages are user-friendly and clearly explain why the pattern is invalid.

# Test Strategy:
Implement unit tests for the validation function/module covering valid inputs ('drawing', 'writing', 'drawing,writing', etc.) and a wide range of invalid inputs (empty string, spaces, invalid types like 'painting', mixed case, extra commas, incorrect separators, non-string types). Verify that valid inputs are parsed correctly and invalid inputs result in the expected error or error message. Implement integration tests for the command or service that uses this validation (e.g., the `/new season` command) to ensure invalid patterns are rejected with clear error messages displayed to the user.

# Subtasks:
## 1. Create Turn Pattern Validation Function [pending]
### Dependencies: None
### Description: Develop a core validation function that checks if a turn pattern string follows the required format
### Details:
Create a function named validateTurnPattern that accepts a string input. The function should verify that the input is a non-empty string, split it by commas, and check that each element (after trimming whitespace) is exactly 'drawing' or 'writing'. Return a parsed array if valid, or throw a descriptive error if invalid.

## 2. Implement Edge Case Handling [pending]
### Dependencies: 69.1
### Description: Enhance the validation function to handle all specified edge cases
### Details:
Extend the validation function to properly handle edge cases including empty strings, strings with extra commas (e.g., 'drawing,,writing'), strings with only commas, and non-string inputs. Each case should produce an appropriate error message that clearly identifies the specific validation issue.

## 3. Design Error Handling Strategy [pending]
### Dependencies: 69.1
### Description: Create a consistent approach for error handling and messaging
### Details:
Define a strategy for error handling, either by throwing custom error objects or returning structured error messages. Create clear, user-friendly error messages for each validation failure case. Messages should explain exactly what was wrong with the input and how to correct it (e.g., 'Turn pattern must be a comma-separated list containing only 'drawing' and 'writing' values').

## 4. Integrate Validation with Command Handler [pending]
### Dependencies: 69.1, 69.2, 69.3
### Description: Incorporate the validation function into the /new season command flow
### Details:
Integrate the validation function into the /new season command handler or wherever turn patterns are initially processed. Ensure that validation occurs before any attempt to create or modify season/game data. Add appropriate error handling to present validation errors to users in a friendly manner.

## 5. Update SeasonService Implementation [pending]
### Dependencies: 69.4
### Description: Modify the SeasonService to use the validation function
### Details:
Update the SeasonService class or module to use the turn pattern validation function when creating or updating seasons/games. Ensure that invalid patterns are rejected at the service level before any database operations occur. Add appropriate documentation for the validation requirements in relevant service methods.

